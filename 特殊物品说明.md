# RandomItemPVP 特殊物品能力说明

## 🎯 新增特殊物品功能

### 🔥 火焰弹投掷系统

**使用方法：**
1. 获得火焰弹后，**右键点击**（空中或对准方块都可以）即可投掷
2. 火焰弹会快速飞出，命中目标后点燃

**特性参数：**
- ⏱️ **冷却时间**：2秒（40 ticks）
- 🚀 **飞行速度**：1.5（比TNT更快）
- 🔥 **点燃效果**：命中方块和实体都会点燃
- 💨 **无爆炸**：不会造成爆炸伤害，只点燃

**游戏提示：**
- 投掷后消耗1个火焰弹
- 冷却时间短，可以连续使用
- 投掷时有火焰和岩浆粒子效果
- 适合骚扰敌人和控制区域

**平衡性考虑：**
- 2秒冷却允许快速连发
- 无爆炸伤害，主要用于点燃和控制
- 飞行速度快，容易命中
- 可以点燃敌人造成持续伤害

---

### 💣 TNT 投掷系统

**使用方法：**
1. 获得 TNT 后，**右键点击**（空中或对准方块都可以）即可投掷
2. TNT 会以抛物线飞出，落地后不会立即爆炸

**特性参数：**
- ⏱️ **引爆时间**：2.5秒（50 ticks）
- 🕐 **冷却时间**：5秒（100 ticks）
- 💥 **爆炸威力**：3.0（略低于原版4.0，保持平衡）
- 🎯 **投掷力度**：0.8（适中的抛射距离，经过平衡调整）

**游戏提示：**
- 投掷后会消耗1个 TNT
- 冷却期间右键会显示剩余秒数
- 投掷时有音效和粒子效果
- 可以用来炸开防御工事、击杀敌人或制造地形优势

**平衡性考虑：**
- 5秒冷却避免连续投掷刷屏
- 降低爆炸威力避免一击致命
- 2.5秒引爆给对手反应时间

---

### 💎 末影水晶特殊放置

**原版限制：**
- 末影水晶只能放置在黑曜石或基岩上

**新特性：**
- ✅ 可以放置在**任何固体方块**上
- ✅ 包括：石头、泥土、木板、圆石等所有固体方块
- ✅ 放置成功时有音效提示

**使用方法：**
1. 获得末影水晶
2. 对着任意固体方块的顶面**右键点击**即可放置
3. 系统会自动在方块上方生成末影水晶实体
4. 攻击末影水晶会产生大爆炸

**战术应用：**
- 设置陷阱：在常见路径放置水晶
- 区域控制：利用爆炸威慑敌人
- 破坏地形：炸开通道或制造障碍
- 防御据点：在据点周围布置水晶防线

**爆炸参数：**
- 💥 **爆炸威力**：4.0（原版6.0，已降低保持平衡）
- 🔥 **破坏地形**：会破坏方块
- ⚠️ **范围伤害**：会伤害所有附近的玩家（包括自己）
- 🛡️ **建议距离**：保持至少5格安全距离

---

## 🎮 游戏平衡性设计

### 火焰弹平衡性
| 特性 | 数值 | 原因 |
|-----|------|------|
| 冷却时间 | 2秒 | 短CD适合连续使用 |
| 飞行速度 | 1.5 | 快速飞行，易于命中 |
| 伤害类型 | 点燃 | 持续伤害而非瞬间爆炸 |
| 控场能力 | 高 | 可以封锁区域和骚扰敌人 |

### TNT 平衡性
| 特性 | 数值 | 原因 |
|-----|------|------|
| 爆炸威力 | 3.0 | 避免秒杀，给玩家反应时间 |
| 引爆延迟 | 2.5秒 | 可以逃跑或反制 |
| 冷却时间 | 5秒 | 防止spam，需要策略使用 |
| 投掷力度 | 1.2 | 适中距离，不会太远或太近 |

### 末影水晶平衡性
| 特性 | 数值 | 原因 |
|-----|------|------|
| 爆炸威力 | 4.0 | 降低自原版6.0，避免过于强势 |
| 放置限制 | 无限制 | 增加策略性和不可预测性 |
| 触发方式 | 攻击触发 | 需要主动触发，有反应时间 |
| 风险回报 | 高风险高回报 | 放置容易，但可能误伤自己 |

---

## 🎯 战术建议

### 火焰弹使用技巧
1. **快速骚扰**：短CD适合连续投掷骚扰敌人
2. **区域封锁**：点燃地面形成火墙阻挡追击
3. **持续伤害**：点燃敌人造成持续火焰伤害
4. **视野控制**：火焰粒子可以干扰敌人视线

### TNT 使用技巧
1. **远程骚扰**：投掷到敌人附近造成压力
2. **地形破坏**：炸开掩体或制造掩体
3. **逃跑工具**：投掷身后阻挡追击者
4. **配合其他物品**：炸飞敌人后用弓箭补刀

### 末影水晶使用技巧
1. **陷阱设置**：在桥梁、通道等必经之路放置
2. **据点防御**：在基地周围布置水晶防线
3. **主动出击**：冲脸放置水晶同归于尽
4. **地形改造**：快速炸开大面积区域

### 组合战术
- **火焰弹 + 弓箭**：先点燃敌人造成混乱，然后射箭补刀
- **火焰弹 + 末影水晶**：火墙封路，水晶阻击
- **TNT + 末影水晶**：用TNT炸飞敌人，在落点放水晶
- **弓箭 + 末影水晶**：远程引爆水晶陷阱
- **盾牌 + TNT**：防御反击，投掷TNT后立即格挡
- **火焰弹连发**：利用短CD连续投掷形成火力压制

---

## ⚙️ 技术细节

### 冷却系统
- 使用 UUID 追踪每个玩家
- 基于时间戳计算冷却
- 游戏结束自动清除所有冷却

### 事件监听
- `PlayerInteractEvent`：TNT 和火焰弹右键投掷
- `BlockPlaceEvent`：末影水晶放置检测
- `EntityDamageByEntityEvent`：末影水晶爆炸控制

### 性能优化
- 冷却时间使用轻量级 HashMap 存储
- 游戏结束及时清理避免内存泄漏
- 事件只在游戏运行时处理

---

## 📝 配置信息

这些特殊功能的参数已内置在代码中，暂不支持配置文件修改。

如需调整参数，请在 `ItemAbilityManager.java` 中修改以下常量：

```java
TNT_COOLDOWN_TICKS = 100L;           // TNT冷却时间（ticks）
TNT_FUSE_TICKS = 50;                 // TNT引爆时间（ticks）
TNT_THROW_POWER = 1.2f;              // TNT投掷力度
TNT_EXPLOSION_POWER = 3.0f;          // TNT爆炸威力
CRYSTAL_EXPLOSION_POWER = 4.0f;      // 末影水晶爆炸威力
FIREBALL_THROW_POWER = 1.5f;         // 火焰弹投掷力度
FIREBALL_COOLDOWN_MS = 2000L;        // 火焰弹冷却时间（毫秒）
```

---

## 🐛 已知问题 & 注意事项

1. ✅ TNT 投掷在 Folia/Luminol 1.21.7 上完美运行
2. ✅ 末影水晶放置机制已充分测试
3. ⚠️ 注意：末影水晶爆炸会清除大量方块（游戏结束会清理）
4. ⚠️ TNT 爆炸也可能误伤自己，请注意距离
5. 💡 建议：在PVP时合理使用冷却时间，不要浪费

---

## 🎉 更新日志

**v2.0.0 新特性：**
- ✅ **火焰弹投掷**：右键投掷，2秒CD，点燃目标
- ✅ TNT 可右键投掷，5秒CD，威力3.0
- ✅ 末影水晶可放置在任意固体方块
- ✅ 末影水晶爆炸威力降低至4.0（原版6.0）
- ✅ 完整的冷却系统和视觉反馈
- ✅ 游戏平衡性调整（降低爆炸威力）
- ✅ 自动清理系统（游戏结束清除冷却）
- ✅ 自定义爆炸控制系统
- ✅ 火焰弹快速飞行和点燃效果

---

**祝游戏愉快！🎮**

